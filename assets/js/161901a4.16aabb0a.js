"use strict";(globalThis.webpackChunktemp_docusaurus_init=globalThis.webpackChunktemp_docusaurus_init||[]).push([[3982],{8039:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"module-1/python-agents-rclpy","title":"Python Agents and rclpy","description":"Short Overview","source":"@site/docs/module-1/python-agents-rclpy.mdx","sourceDirName":"module-1","slug":"/module-1/python-agents-rclpy","permalink":"/Physical-AI-Humanoid-Robotics-TextBook/docs/module-1/python-agents-rclpy","draft":false,"unlisted":false,"editUrl":"https://github.com/IdreesKhan12/Physical-AI-Humanoid-Robotics-TextBook/tree/main/docs/module-1/python-agents-rclpy.mdx","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"title":"Python Agents and rclpy","sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"ROS 2 Architecture and Core Concepts","permalink":"/Physical-AI-Humanoid-Robotics-TextBook/docs/module-1/ros2-core-concepts"},"next":{"title":"Robot Description (URDF)","permalink":"/Physical-AI-Humanoid-Robotics-TextBook/docs/module-1/launch-urdf"}}');var s=r(4848),t=r(8453);const a={title:"Python Agents and rclpy",sidebar_position:2},o=void 0,l={},c=[{value:"Short Overview",id:"short-overview",level:2},{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"Main Sections",id:"main-sections",level:2},{value:"1. Interfacing Python with ROS 2: An Introduction to <code>rclpy</code>",id:"1-interfacing-python-with-ros-2-an-introduction-to-rclpy",level:3},{value:"2. Building a Minimal Publisher Node",id:"2-building-a-minimal-publisher-node",level:3},{value:"<code>telemetry_publisher.py</code> (Minimal Publisher Node)",id:"telemetry_publisherpy-minimal-publisher-node",level:4},{value:"3. Building a Minimal Subscriber Node",id:"3-building-a-minimal-subscriber-node",level:3},{value:"<code>data_logger_subscriber.py</code> (Minimal Subscriber Node)",id:"data_logger_subscriberpy-minimal-subscriber-node",level:4},{value:"4. ROS 2 Python Package Management",id:"4-ros-2-python-package-management",level:3},{value:"<code>package.xml</code> Updates",id:"packagexml-updates",level:4},{value:"<code>setup.py</code> Updates",id:"setuppy-updates",level:4},{value:"5. Building and Verifying Communication",id:"5-building-and-verifying-communication",level:3},{value:"6. Example Analogy: Telemetry and Data Logging",id:"6-example-analogy-telemetry-and-data-logging",level:3},{value:"Summary Key Points",id:"summary-key-points",level:2},{value:"Reading/Research References (APA 7th Edition)",id:"readingresearch-references-apa-7th-edition",level:2}];function d(e){const n={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"short-overview",children:"Short Overview"}),"\n",(0,s.jsxs)(n.p,{children:["This chapter provides a hands-on guide for developers to implement core ROS 2 communication paradigms\u2014Publishers and Subscribers\u2014using the Python client library, ",(0,s.jsx)(n.code,{children:"rclpy"}),". It focuses on practical code examples, package management with ",(0,s.jsx)(n.code,{children:"setup.py"})," and ",(0,s.jsx)(n.code,{children:"package.xml"}),", and testing procedures to ensure functional ROS 2 Python agents."]}),"\n",(0,s.jsx)(n.h2,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,s.jsx)(n.p,{children:"By the end of this chapter, you will be able to:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Implement complete, runnable Python code for minimal Publisher and Subscriber Nodes using ",(0,s.jsx)(n.code,{children:"rclpy"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Correctly update ",(0,s.jsx)(n.code,{children:"setup.py"})," and ",(0,s.jsx)(n.code,{children:"package.xml"})," to build a Python ROS 2 package."]}),"\n",(0,s.jsxs)(n.li,{children:["Build a ROS 2 package using ",(0,s.jsx)(n.code,{children:"colcon build"})," and verify communication with ",(0,s.jsx)(n.code,{children:"ros2 run"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"main-sections",children:"Main Sections"}),"\n",(0,s.jsxs)(n.h3,{id:"1-interfacing-python-with-ros-2-an-introduction-to-rclpy",children:["1. Interfacing Python with ROS 2: An Introduction to ",(0,s.jsx)(n.code,{children:"rclpy"})]}),"\n",(0,s.jsxs)(n.p,{children:["ROS 2 offers ",(0,s.jsx)(n.code,{children:"rclpy"})," as its official Python client library, enabling Python developers to easily create nodes and interface with the ROS 2 ecosystem. ",(0,s.jsx)(n.code,{children:"rclpy"})," provides Python bindings for the core ROS Client Library (RCL), allowing for efficient and idiomatic Python development within ROS 2."]}),"\n",(0,s.jsx)(n.h3,{id:"2-building-a-minimal-publisher-node",children:"2. Building a Minimal Publisher Node"}),"\n",(0,s.jsx)(n.p,{children:'A Publisher Node is responsible for sending data to a Topic. In our robot analogy, imagine a "Telemetry Publisher" node on a robot sending sensor readings like battery level or motor status.'}),"\n",(0,s.jsxs)(n.h4,{id:"telemetry_publisherpy-minimal-publisher-node",children:[(0,s.jsx)(n.code,{children:"telemetry_publisher.py"})," (Minimal Publisher Node)"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.node import Node\r\nfrom std_msgs.msg import String\r\n\r\nclass TelemetryPublisher(Node):\r\n\r\n    def __init__(self):\r\n        super().__init__('telemetry_publisher')\r\n        self.publisher_ = self.create_publisher(String, 'telemetry_topic', 10)\r\n        timer_period = 0.5  # seconds\r\n        self.timer = self.create_timer(timer_period, self.timer_callback)\r\n        self.i = 0\r\n\r\n    def timer_callback(self):\r\n        msg = String()\r\n        msg.data = f'Telemetry Data: {self.i}'\r\n        self.publisher_.publish(msg)\r\n        self.get_logger().info(f'Publishing: \"{msg.data}\"')\r\n        self.i += 1\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    telemetry_publisher = TelemetryPublisher()\r\n    rclpy.spin(telemetry_publisher)\r\n    telemetry_publisher.destroy_node()\r\n    rclpy.shutdown()\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,s.jsx)(n.h3,{id:"3-building-a-minimal-subscriber-node",children:"3. Building a Minimal Subscriber Node"}),"\n",(0,s.jsx)(n.p,{children:'A Subscriber Node is responsible for receiving data from a Topic. Following our analogy, a "Data Logger Subscriber" node might receive the telemetry data and print it to the console, or save it to a file.'}),"\n",(0,s.jsxs)(n.h4,{id:"data_logger_subscriberpy-minimal-subscriber-node",children:[(0,s.jsx)(n.code,{children:"data_logger_subscriber.py"})," (Minimal Subscriber Node)"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.node import Node\r\nfrom std_msgs.msg import String\r\n\r\nclass DataLoggerSubscriber(Node):\r\n\r\n    def __init__(self):\r\n        super().__init__('data_logger_subscriber')\r\n        self.subscription = self.create_subscription(\r\n            String,\r\n            'telemetry_topic',\r\n            self.listener_callback,\r\n            10)\r\n        self.subscription  # prevent unused variable warning\r\n\r\n    def listener_callback(self, msg):\r\n        self.get_logger().info(f'I heard: \"{msg.data}\"')\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    data_logger_subscriber = DataLoggerSubscriber()\r\n    rclpy.spin(data_logger_subscriber)\r\n    data_logger_subscriber.destroy_node()\r\n    rclpy.shutdown()\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,s.jsx)(n.h3,{id:"4-ros-2-python-package-management",children:"4. ROS 2 Python Package Management"}),"\n",(0,s.jsxs)(n.p,{children:["To make these Python nodes runnable within ROS 2, they need to be part of a package. This involves configuring ",(0,s.jsx)(n.code,{children:"package.xml"})," and ",(0,s.jsx)(n.code,{children:"setup.py"}),"."]}),"\n",(0,s.jsxs)(n.h4,{id:"packagexml-updates",children:[(0,s.jsx)(n.code,{children:"package.xml"})," Updates"]}),"\n",(0,s.jsxs)(n.p,{children:["Your ",(0,s.jsx)(n.code,{children:"package.xml"})," should include dependencies for ",(0,s.jsx)(n.code,{children:"rclpy"})," and ",(0,s.jsx)(n.code,{children:"std_msgs"}),", and specify the Python executable format."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<?xml version="1.0"?>\r\n<?xml-model href="http://download.ros.org/schema/package_format3.xsd" schematypens="http://www.w3.org/2001/XMLSchema"?>\r\n<package format="3">\r\n  <name>my_python_pkg</name>\r\n  <version>0.0.0</version>\r\n  <description>TODO: Package description</description>\r\n  <maintainer email="user@todo.todo">user</maintainer>\r\n  <license>TODO: License declaration</license>\r\n\r\n  <depend>rclpy</depend>\r\n  <depend>std_msgs</depend>\r\n\r\n  <test_depend>ament_copyright</test_depend>\r\n  <test_depend>ament_flake8</test_depend>\r\n  <test_depend>ament_pep257</test_depend>\r\n  <test_depend>python3-pytest</test_depend>\r\n\r\n  <export>\r\n    <build_type>ament_python</build_type>\r\n  </export>\r\n</package>\n'})}),"\n",(0,s.jsxs)(n.h4,{id:"setuppy-updates",children:[(0,s.jsx)(n.code,{children:"setup.py"})," Updates"]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"setup.py"})," file tells ",(0,s.jsx)(n.code,{children:"colcon"})," how to install your Python scripts as executables."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"from setuptools import find_packages, setup\r\n\r\npackage_name = 'my_python_pkg'\r\n\r\nsetup(\r\n    name=package_name,\r\n    version='0.0.0',\r\n    packages=find_packages(exclude=['test']),\r\n    data_files=[\r\n        ('share/ament_index/resource_index/packages',\r\n            ['resource/' + package_name]),\r\n        ('share/' + package_name, ['package.xml']),\r\n    ],\r\n    install_requires=['setuptools'],\r\n    zip_safe=True,\r\n    maintainer='user',\r\n    maintainer_email='user@todo.todo',\r\n    description='TODO: Package description',\r\n    license='TODO: License declaration',\r\n    tests_require=['pytest'],\r\n    entry_points={\r\n        'console_scripts': [\r\n            'telemetry_publisher = my_python_pkg.telemetry_publisher:main',\r\n            'data_logger_subscriber = my_python_pkg.data_logger_subscriber:main',\r\n        ],\r\n    },\r\n)\n"})}),"\n",(0,s.jsxs)(n.p,{children:["In ",(0,s.jsx)(n.code,{children:"entry_points"}),", we define our executable scripts, mapping a command name (",(0,s.jsx)(n.code,{children:"telemetry_publisher"}),", ",(0,s.jsx)(n.code,{children:"data_logger_subscriber"}),") to the Python module and main function."]}),"\n",(0,s.jsx)(n.h3,{id:"5-building-and-verifying-communication",children:"5. Building and Verifying Communication"}),"\n",(0,s.jsxs)(n.p,{children:["Once your package files are set up, navigate to your ROS 2 workspace (",(0,s.jsx)(n.code,{children:"~/ros2_ws"}),") and build:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"colcon build --packages-select my_python_pkg\n"})}),"\n",(0,s.jsxs)(n.p,{children:["After building, source your workspace again in a ",(0,s.jsx)(n.em,{children:"new terminal"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:". install/setup.bash\n"})}),"\n",(0,s.jsx)(n.p,{children:"Now, run your nodes:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Start the publisher"}),":","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"ros2 run my_python_pkg telemetry_publisher\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Start the subscriber in a new terminal"}),":","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"ros2 run my_python_pkg data_logger_subscriber\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"You should see the subscriber printing the telemetry data from the publisher, confirming successful Python-based ROS 2 communication!"}),"\n",(0,s.jsx)(n.h3,{id:"6-example-analogy-telemetry-and-data-logging",children:"6. Example Analogy: Telemetry and Data Logging"}),"\n",(0,s.jsx)(n.p,{children:'Throughout this chapter, we used a simple "Telemetry Publisher" on a robot sending data, and a "Data Logger Subscriber" on a base station receiving and recording that data. This illustrates the fundamental flow of information in a robot system using ROS 2 Topics.'}),"\n",(0,s.jsx)(n.h2,{id:"summary-key-points",children:"Summary Key Points"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"rclpy"})," is the official Python client library for ROS 2, enabling Python nodes."]}),"\n",(0,s.jsx)(n.li,{children:"Publisher nodes send messages on topics, and Subscriber nodes receive them."}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"std_msgs/String"})," is a common message type for text data."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"package.xml"})," declares package dependencies, and ",(0,s.jsx)(n.code,{children:"setup.py"})," defines Python executables."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"colcon build"})," compiles ROS 2 workspaces, and sourcing the setup file integrates them into the environment."]}),"\n",(0,s.jsxs)(n.li,{children:["The ",(0,s.jsx)(n.code,{children:"ros2 run"})," command launches nodes, facilitating communication verification."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"readingresearch-references-apa-7th-edition",children:"Reading/Research References (APA 7th Edition)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["ROS 2 Documentation. (n.d.). ",(0,s.jsx)(n.em,{children:"rclpy (Python client)"}),". Retrieved from ",(0,s.jsx)(n.a,{href:"https://docs.ros.org/en/humble/Tutorials/Beginner-Client-Libraries/Creating-a-ROS2-Package-With-Python-and-Ament-CMake.html",children:"https://docs.ros.org/en/humble/Tutorials/Beginner-Client-Libraries/Creating-a-ROS2-Package-With-Python-and-Ament-CMake.html"})]}),"\n",(0,s.jsxs)(n.li,{children:["ROS 2 Documentation. (n.d.). ",(0,s.jsx)(n.em,{children:"Writing a Simple Publisher and Subscriber (Python)"}),". Retrieved from ",(0,s.jsx)(n.a,{href:"https://docs.ros.org/en/humble/Tutorials/Beginner-Client-Libraries/Writing-A-Simple-Publisher-And-Subscriber-Python.html",children:"https://docs.ros.org/en/humble/Tutorials/Beginner-Client-Libraries/Writing-A-Simple-Publisher-And-Subscriber-Python.html"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.em,{children:"colcon Documentation"}),". (n.d.). Retrieved from ",(0,s.jsx)(n.a,{href:"https://colcon.readthedocs.io/en/released/",children:"https://colcon.readthedocs.io/en/released/"})]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>a,x:()=>o});var i=r(6540);const s={},t=i.createContext(s);function a(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);